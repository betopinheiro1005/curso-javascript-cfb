<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <title>m√©todos requestAnimationFrame e cancelAnimationFrame</title>
    <meta charset="utf-8" />
    <style>
      #jogador {
        position: absolute;
        top: 10px;
        left: 10px;
        background-color: #00f;
        width: 50px;
        height: 50px;
      }
      #btIni,
      #btPara {
        margin-top: 10px;
        margin-left: 10px;
        padding: 10px;
        font-size: 16px;
      }
      #btIni {
        display: none;
      }
    </style>
    <script>
      var jog;
      var vel;
      var dx;
      var dy;
      var px;
      var py;
      var frames;
      var estado;

      function inicia() {
        vel = 1;
        dx = 1;
        dy = 0;
        px = 0;
        py = 0;
        estado = 1;
        jog = document.getElementById('jogador');
        jog.addEventListener('click', movePara);
        document.getElementById('btIni').addEventListener('click', move);
        document.getElementById('btPara').addEventListener('click', para);
        game();
      }

      function movePara() {
        if (estado) {
          estado = 0;
          jog.style.backgroundColor = '#f00';
          cancelAnimationFrame(frames);
          document.getElementById('btIni').style.display = 'inline';
          document.getElementById('btPara').style.display = 'none';
        } else {
          estado = 1;
          jog.style.backgroundColor = '#00f';
          frames = requestAnimationFrame(game);
          document.getElementById('btIni').style.display = 'none';
          document.getElementById('btPara').style.display = 'inline';
        }
      }

      function move() {
        if (!estado) {
          estado = 1;
          jog.style.backgroundColor = '#00f';
          frames = requestAnimationFrame(game);
          document.getElementById('btIni').style.display = 'none';
          document.getElementById('btPara').style.display = 'inline';
        }
      }

      function para() {
        estado = 0;
        jog.style.backgroundColor = '#f00';
        cancelAnimationFrame(frames);
        document.getElementById('btIni').style.display = 'inline';
        document.getElementById('btPara').style.display = 'none';
      }

      function game() {
        //controle movimento
        px += dx * vel * estado;
        py += dy * vel * estado;
        if (px >= 500 || px <= 0) {
          dx *= -1;
        }
        jog.style.left = px + 'px';
        frames = requestAnimationFrame(game);
      }

      window.addEventListener('load', inicia);
    </script>
  </head>
  <body>
    <div id="jogador"></div>
    <button id="btIni">Iniciar</button>
    <button id="btPara">Parar</button>
  </body>
</html>
